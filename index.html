<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDNC 一括通知レター</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="app-container">
        <header class="app-header">
            <h1>DDNC 一括通知レター</h1>
        </header>

        <div id="initial-steps-container">
            <div class="card upload-section" id="step1-card">
                <h2>ステップ1：NEHOPSからゲストリストを出力</h2>
                <div class="instruction-box">
                    <ol class="nehops-steps">
                        <li>帳票.分析</li>
                        <li>宿泊帳票メニュー</li>
                        <li>フロント帳票</li>
                        <li>ゲストリスト</li>
                        <li>出力</li>
                        <li>エクスポート</li>
                        <li>ファイル種類: <strong>.CSV</strong></li>
                        <li>保存</li>
                    </ol>
                    <p class="tip">**デスクトップに保存した方が探しやすい**</p>
                </div>
            </div>

            <div class="card upload-section">
                 <h2>ステップ2：ゲストリスト (CSV) をアップロード</h2>
                <label for="csv-upload" class="file-upload-label">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
                    <span>ファイルを選択</span>
                </label>
                <input type="file" id="csv-upload" accept=".csv" class="file-upload-input">
                <p id="upload-status">エクスポートしたCSVファイルをアップロードしてください。</p>
            </div>
        </div>

        <button id="show-upload-btn" type="button" class="floating-btn hidden" title="ファイルを再アップロード">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
        </button>


        <div id="letter-generation-section" class="hidden">
            <div class="card input-group">
                <h2>ステップ3：部屋番号を入力</h2>
                <div id="room-entry-container">
                </div>
                <div class="actions">
                    <button id="add-room-btn" type="button">+ 部屋を追加</button>
                </div>
            </div>

            <div class="card input-group">
                 <h2>ステップ4：担当者名を入力</h2>
                <label for="clerk-name" class="sr-only">担当者名:</label>
                <input type="text" id="clerk-name" placeholder="例：NAKAYAMA または 中山">
            </div>

            <button id="generate-btn" type="button" class="generate-button">
                 <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zM16 18H8v-2h8v2zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V2z"/></svg>
                <span>レターを作成・プレビュー</span>
            </button>
        </div>
    </div>

    <div id="print-area"></div>

    <template id="letter-template">
        <div class="page">
            <div class="letter-half guest-copy">
                 <div class="header">
                    <img src="remm.jpg" alt="Hotel Logo" class="logo">
                    <h2 class="title"></h2>
                </div>
                <div class="recipient-info">
                    <span class="room-details">
                        <strong><span class="label-room-no">Room No:</span></strong> <span class="data-room-number"></span>
                    </span>
                    <span class="date-details">
                        <strong><span class="label-date">Date:</span></strong> <span class="data-date"></span>
                    </span>
                </div>
                 <p class="guest-name-line">
                    <strong><span class="label-guest-name">Guest Name:</span></strong> <span class="data-guest-name"></span>
                </p>
                <div class="letter-body"></div>
                <div class="footer">
                    <div class="signature">
                        <span class="label-clerk">Clerk</span><br>
                        <span class="data-clerk-name"></span>
                    </div>
                </div>
            </div>
            <div class="letter-half front-desk-copy">
                <div class="header">
                    <img src="remm.jpg" alt="Hotel Logo" class="logo">
                    <h2 class="title"></h2>
                </div>
                <div class="recipient-info">
                    <span class="room-details">
                        <strong><span class="label-room-no">Room No:</span></strong> <span class="data-room-number"></span>
                    </span>
                    <span class="date-details">
                        <strong><span class="label-date">Date:</span></strong> <span class="data-date"></span>
                    </span>
                </div>
                <p class="guest-name-line">
                    <strong><span class="label-guest-name">Guest Name:</span></strong> <span class="data-guest-name"></span>
                </p>
                <div class="letter-body"></div>
                <div class="footer">
                    <div class="signature">
                        <span class="label-clerk">Clerk</span><br>
                        <span class="data-clerk-name"></span>
                    </div>
                    <p class="copy-indicator">[ FRONT DESK COPY ]</p>
                </div>
            </div>
        </div>
    </template>

    <script src="script.js"></script>

</body>
</html>

